<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>묘묘의 집 — Cat Fandom MVP</title>
  <meta name="description" content="고양이 묘묘의 아카이브와 다꾸 감성 방명록 MVP" />

  <!-- 간단 파비콘(404 방지) -->
  <link rel="icon"
        href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Ctext y='14' font-size='14'%3E🐱%3C/text%3E%3C/svg%3E">

  <style>
    :root{
      --bg:#faf8f6;--paper:#fff;--ink:#222;--sub:#666;--brand:#ff7892;--brand2:#ffd7e0;--line:#eee;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--ink);font-family: ui-rounded, "Pretendard", system-ui, -apple-system, Segoe UI, Roboto, Apple SD Gothic Neo, "Apple Color Emoji", Noto Color Emoji, sans-serif}
    header{position:sticky;top:0;background:linear-gradient(180deg,#fff,rgba(255,255,255,.92));backdrop-filter:saturate(1.2) blur(8px);border-bottom:1px solid var(--line);z-index:20}
    .wrap{max-width:980px;margin:0 auto;padding:16px}
    .brand{display:flex;gap:10px;align-items:center}
    .brand b{font-size:20px}
    nav{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .tab{appearance:none;border:1px solid var(--line);background:var(--paper);padding:8px 12px;border-radius:999px;cursor:pointer}
    .tab[aria-current="page"]{border-color:var(--brand);box-shadow:0 0 0 2px var(--brand2)}

    main{padding:20px}
    .card{background:var(--paper);border:1px solid var(--line);border-radius:16px;padding:16px;box-shadow:0 8px 24px rgba(0,0,0,.04)}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:14px}
    .muted{color:var(--sub);font-size:14px}
    .btn{appearance:none;border:1px solid var(--line);background:var(--paper);padding:8px 12px;border-radius:10px;cursor:pointer}
    .btn.primary{border-color:var(--brand);background:linear-gradient(180deg,#fff,var(--brand2));}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    .input, textarea, select{width:100%;padding:10px;border:1px solid var(--line);border-radius:10px;background:#fff}
    textarea{min-height:90px;resize:vertical}
    .tag{display:inline-flex;align-items:center;gap:6px;background:var(--brand2);border-radius:999px;padding:4px 8px;font-size:12px;border:1px solid var(--brand)}
    .pill{display:inline-flex;align-items:center;gap:6px;background:#f6f6f6;border-radius:999px;padding:4px 8px;font-size:12px;border:1px solid var(--line)}
    .paper-edge{position:relative}
    .paper-edge:after{content:"";position:absolute;inset:0;border-radius:16px;background:repeating-linear-gradient(45deg, transparent 0 10px, rgba(255,180,200,.2) 10px 20px);mask:linear-gradient(#000,#000) content-box, linear-gradient(#000,#000);mask-composite:exclude;padding:1px;border:1px solid transparent}
    .stamp{font-weight:700;color:#c74;font-size:12px;border:2px dashed #c74;border-radius:8px;padding:2px 6px;display:inline-block;transform:rotate(-6deg)}
    .ghost{opacity:.6}
    .hide{display:none}
    .footer{padding:60px 20px;color:var(--sub);text-align:center}
    figure{margin:0}
    img{max-width:100%;height:auto;border-radius:12px;border:1px solid var(--line);display:block}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="brand" aria-label="사이트 제목">
        <svg width="28" height="28" viewBox="0 0 24 24" aria-hidden="true"><path fill="#ff7892" d="M12 2c2.5 0 4.5 2 4.5 4.5c0 1.7-.9 3.2-2.3 4.1c2.5.7 4.3 3 4.3 5.7V20a2 2 0 0 1-2 2H7.5a2 2 0 0 1-2-2v-3.7c0-2.7 1.8-5 4.3-5.7A4.5 4.5 0 0 1 7.5 6.5C7.5 4 9.5 2 12 2Z"/></svg>
        <b>묘묘의 집</b>
        <span class="pill" aria-live="polite" id="today-pill">오늘의 묘묘 운세 로딩중…</span>
      </div>
      <nav aria-label="주요 탐색" class="row">
        <button class="tab" data-page="home" aria-current="page">홈</button>
        <button class="tab" data-page="archive">아카이브</button>
        <button class="tab" data-page="guestbook">방명록</button>
        <button class="tab" data-page="goodies">보너스</button>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <!-- 홈 -->
    <section id="page-home" class="page">
      <div class="card paper-edge">
        <div class="row" style="align-items:center;justify-content:space-between">
          <h2 style="margin:0">오늘의 묘묘 🐾</h2>
          <span class="tag"><span aria-hidden>✨</span> 랜덤 카드</span>
        </div>
        <div class="row" style="margin-top:12px;align-items:flex-start">
          <figure style="flex:1 1 320px;max-width:520px">
            <img id="hero-img" alt="오늘의 묘묘 사진" src="https://placekitten.com/600/380"/>
            <figcaption class="muted" id="hero-caption">플레이스홀더 — 나중에 내 갤러리/인스타 연동</figcaption>
          </figure>
          <div style="flex:1 1 320px;min-width:240px">
            <p id="fortune" style="font-size:18px;line-height:1.5">운세 로딩중…</p>
            <div class="row">
              <button class="btn primary" id="btn-refresh">오늘 카드 새로 뽑기</button>
              <button class="btn" id="btn-swap">사진 바꾸기</button>
            </div>
            <p class="muted" style="margin-top:8px">※ 아래에 유튜브/인스타 최신 포스트 자동 노출</p>
          </div>
        </div>

        <hr style="margin:18px 0;border:none;border-top:1px dashed var(--line)">
        <div class="row" style="gap:16px;align-items:flex-start;flex-wrap:wrap">
          <!-- 유튜브 (SociableKit 위젯만 사용) -->
          <section style="flex:1 1 420px;min-width:320px" aria-labelledby="yt-title">
            <h3 id="yt-title" style="margin:6px 0">유튜브 최신 영상 ▶</h3>
            <div class='sk-ww-youtube-channel-videos' data-embed-id='25594678'></div>
            <script src='https://widgets.sociablekit.com/youtube-channel-videos/widget.js' defer></script>
          </section>

          <!-- 인스타그램 (SociableKit 위젯만 사용) -->
          <section style="flex:1 1 420px;min-width:320px" aria-labelledby="ig-title">
            <h3 id="ig-title" style="margin:6px 0">인스타 최신 포스트 ♡</h3>
            <div class='sk-instagram-feed' data-embed-id='25594666'></div>
            <script src='https://widgets.sociablekit.com/instagram-feed/widget.js' defer></script>
          </section>
        </div>
      </div>
    </section>

    <!-- 아카이브 -->
    <section id="page-archive" class="page hide">
      <div class="card">
        <div class="row" style="align-items:center;justify-content:space-between">
          <h2 style="margin:0">아카이브 📂</h2>
        <div class="row">
          <select id="filter-year" aria-label="연도 선택" class="input" style="max-width:140px"></select>
          <select id="filter-tag" aria-label="카테고리 선택" class="input" style="max-width:160px"></select>
        </div>
        </div>
        <p class="muted">연도/카테고리별로 정리된 묘묘 기록. (초기 데모 데이터 → 추후 인스타/유튜브 연동)</p>
        <div id="archive-list" class="grid" aria-live="polite"></div>
      </div>
    </section>

    <!-- 방명록 (다꾸풍) -->
    <section id="page-guestbook" class="page hide">
      <div class="card">
        <h2 style="margin-top:0">방명록 ✍️</h2>
        <p class="muted">손글씨 느낌 + 스티커로 메시지를 남겨보세요. (로컬 저장) </p>
        <form id="guest-form" class="card" style="margin:10px 0;display:grid;gap:10px">
          <div class="row">
            <input class="input" id="nick" placeholder="닉네임" required aria-label="닉네임" style="max-width:220px"/>
            <select id="sticker" class="input" aria-label="스티커 선택" style="max-width:220px">
              <option>🐾 발바닥</option>
              <option>🐱 고양이</option>
              <option>✨ 반짝</option>
              <option>🎀 리본</option>
              <option>🍓 딸기</option>
            </select>
          </div>
          <textarea id="msg" placeholder="메시지" required aria-label="메시지"></textarea>
          <div class="row" style="justify-content:space-between;align-items:center">
            <button class="btn primary" type="submit">남기기</button>
            <button class="btn" type="button" id="clear-guestbook">모두 지우기</button>
          </div>
        </form>
        <div id="guest-list" class="grid" aria-live="polite"></div>
      </div>
    </section>

    <!-- 보너스 (다운로드/공지) -->
    <section id="page-goodies" class="page hide">
      <div class="card">
        <div class="row" style="align-items:center;justify-content:space-between">
          <h2 style="margin:0">보너스 🎁</h2>
          <span class="stamp">coming soon</span>
        </div>
        <p class="muted">직접 만든 스티커팩(PNG/굿노트) 무료 배포, 배경화면, 폰트 가이드 등을 올릴 공간입니다.</p>
        <ul>
          <li>스티커팩 v0: <span class="ghost">업로드 예정</span></li>
          <li>배경화면 v0: <span class="ghost">업로드 예정</span></li>
        </ul>
      </div>
    </section>
  </main>

  <footer class="footer">© <span id="yyyy"></span> 묘묘의 집 — made with ♥</footer>

  <script>
  // ==== 전역 오염 방지: 모든 커스텀 JS를 IIFE로 격리 ====
  (() => {
    // ====== 유틸 ======
    const $ = (sel, el=document) => el.querySelector(sel);
    const $$ = (sel, el=document) => Array.from(el.querySelectorAll(sel));
    const storage = {
      get(key, fallback){ try { return JSON.parse(localStorage.getItem(key)) ?? fallback } catch{ return fallback } },
      set(key, val){
        try { localStorage.setItem(key, JSON.stringify(val)); }
        catch (e) { console.warn('localStorage 사용 불가:', e); }
      }
    }
    const FORTUNES = [
      "오늘은 상자 탐험이 대박! 📦",
      "간식 협상에 유리한 날 🍗",
      "낮잠이 약— 3회 이상 추천 😴",
      "창가 햇살 스팟을 선점하세요 ☀️",
      "빗질 타이밍 좋음 ✂️",
      "장난감 낚시대 히트 확률 ↑ 🎣"
    ];
    function pick(arr){ return arr[Math.floor(Math.random()*arr.length)] }

    // ====== 탭 내비게이션 ======
    $$(".tab").forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const p = btn.dataset.page;
        $$(".tab").forEach(b=> b.removeAttribute('aria-current'))
        btn.setAttribute('aria-current','page');
        $$(".page").forEach(sec=> sec.classList.add('hide'))
        $('#page-'+p).classList.remove('hide')
      })
    });

    // ====== 홈: 랜덤 이미지/운세 ======
    function setFortune(){ $('#fortune').textContent = pick(FORTUNES) }
    function swapHero(){
      const w = 480 + Math.floor(Math.random()*240); // 480~720
      const h = 320 + Math.floor(Math.random()*200); // 320~520
      const img = $('#hero-img');
      img.onload = () => {};
      img.src = `https://placekitten.com/${w}/${h}`;
      $('#hero-caption').textContent = '플레이스홀더 — 나중에 내 갤러리/인스타 연동';
    }
    $('#btn-refresh').addEventListener('click', setFortune);
    $('#btn-swap').addEventListener('click', swapHero);

    // ====== 아카이브 데모 데이터 ======
    const DEMO_ARCHIVE = [
      { id:1, y:2025, tag:'먹방',   title:'츄르 시식회',   img:'https://placekitten.com/420/280', note:'첫 츄르 리뷰', date:'2025-08-12' },
      { id:2, y:2025, tag:'꿀잠',   title:'식빵자세 마스터', img:'https://placekitten.com/421/281', note:'햇살 스팟 발견', date:'2025-07-30' },
      { id:3, y:2024, tag:'장난감', title:'낚시대 격파',    img:'https://placekitten.com/422/282', note:'깃털 분해함',   date:'2024-12-02' },
      { id:4, y:2024, tag:'패션',   title:'리본데이',       img:'https://placekitten.com/423/283', note:'분홍 리본 시도', date:'2024-10-03' },
      { id:5, y:2023, tag:'여행',   title:'창밖 구경',      img:'https://placekitten.com/424/284', note:'차박 첫 경험',   date:'2023-05-15' }
    ];
    function renderArchive(list){
      const wrap = $('#archive-list');
      wrap.innerHTML = '';
      list.forEach(item=>{
        const el = document.createElement('article');
        el.className = 'card';
        el.innerHTML = `
          <figure>
            <img src="${item.img}" alt="${item.title}"/>
            <figcaption class="muted">${item.date} · ${item.tag}</figcaption>
          </figure>
          <h3 style="margin:.5rem 0 0">${item.title}</h3>
          <p class="muted">${item.note}</p>
        `;
        wrap.appendChild(el);
      })
    }
    function setupArchiveFilters(){
      const years = Array.from(new Set(DEMO_ARCHIVE.map(x=>x.y))).sort((a,b)=>b-a);
      const tags  = Array.from(new Set(DEMO_ARCHIVE.map(x=>x.tag)));
      const $y = $('#filter-year');
      const $t = $('#filter-tag');
      $y.innerHTML = '<option value="all">전체 연도</option>' + years.map(y=>`<option>${y}</option>`).join('');
      $t.innerHTML = '<option value="all">전체 카테고리</option>' + tags.map(t=>`<option>${t}</option>`).join('');
      function apply(){
        const yv = $y.value; const tv = $t.value;
        const filtered = DEMO_ARCHIVE.filter(x=> (yv==='all'||x.y==yv) && (tv==='all'||x.tag===tv));
        renderArchive(filtered);
      }
      $y.addEventListener('change', apply); $t.addEventListener('change', apply);
      apply();
    }

    // ====== 방명록 (로컬스토리지) ======
    const GKEY = 'guestbook.v1';
    function loadGuest(){ return storage.get(GKEY, []) }
    function saveGuest(list){ storage.set(GKEY, list) }
    function renderGuest(){
      const list = loadGuest();
      const wrap = $('#guest-list');
      wrap.innerHTML = '';
      if(!list.length){ wrap.innerHTML = '<p class="muted">아직 메시지가 없어요. 첫 메시지를 남겨보세요! ✨</p>'; return }
      list.forEach(x=>{
        const el = document.createElement('article');
        el.className = 'card paper-edge';
        el.innerHTML = `
          <div class="row" style="justify-content:space-between;align-items:center">
            <strong>${x.nick}</strong>
            <span class="tag">${x.sticker}</span>
          </div>
          <p style="white-space:pre-wrap">${x.msg}</p>
          <div class="muted">${new Date(x.ts).toLocaleString()}</div>
        `;
        wrap.appendChild(el);
      })
    }
    $('#guest-form').addEventListener('submit', e=>{
      e.preventDefault();
      const nick = $('#nick').value.trim();
      const msg  = $('#msg').value.trim();
      const sticker = $('#sticker').value;
      if(!nick || !msg) return;
      const list = loadGuest();
      list.unshift({nick, msg, sticker, ts: Date.now()});
      saveGuest(list);
      e.target.reset();
      renderGuest();
    });
    $('#clear-guestbook').addEventListener('click', ()=>{
      if(confirm('방명록을 전부 삭제할까요? (로컬에 저장된 데이터만 삭제됩니다)')){
        saveGuest([]); renderGuest();
      }
    });

    // ====== 초기화 ======
    function init(){
      $('#yyyy').textContent = new Date().getFullYear();
      $('#today-pill').textContent = '오늘: '+pick(['간식확률 ↑','꿀잠데이','캣닢주의','박스매직','빗질OK']);
      setFortune();
      swapHero();
      setupArchiveFilters();
      renderArchive(DEMO_ARCHIVE);
      renderGuest();
      // SociableKit 위젯은 섹션의 <script src="...widget.js" defer>가 각자 처리
    }
    document.addEventListener('DOMContentLoaded', init);
  })();
  </script>
</body>
</html>
